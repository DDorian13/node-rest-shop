{"ast":null,"code":"import { useEffect } from 'react';\nimport { useRefresh } from '../sideEffect';\nimport useIsAutomaticRefreshEnabled from './useIsAutomaticRefreshEnabled';\n/**\r\n * Trigger a refresh of the page when the page comes back from background after a certain delay\r\n *\r\n * @param {number} delay Delay in milliseconds since the time the page was hidden. Defaults to 5 minutes.\r\n */\n\nvar useRefreshWhenVisible = function (delay) {\n  if (delay === void 0) {\n    delay = 1000 * 60 * 5;\n  }\n\n  var refresh = useRefresh();\n  var automaticRefreshEnabled = useIsAutomaticRefreshEnabled();\n  useEffect(function () {\n    var lastHiddenTime;\n\n    var handleVisibilityChange = function () {\n      if (!automaticRefreshEnabled) {\n        return;\n      }\n\n      if (document.hidden) {\n        // tab goes hidden\n        lastHiddenTime = Date.now();\n      } else {\n        // tab goes visible\n        if (Date.now() - lastHiddenTime > delay) {\n          refresh();\n        }\n\n        lastHiddenTime = null;\n      }\n    };\n\n    document.addEventListener('visibilitychange', handleVisibilityChange, {\n      capture: true\n    });\n    return function () {\n      return document.removeEventListener('visibilitychange', handleVisibilityChange, {\n        capture: true\n      });\n    };\n  }, [automaticRefreshEnabled, delay, refresh]);\n};\n\nexport default useRefreshWhenVisible;","map":{"version":3,"sources":["C:/Users/Felhasználó/IdeaProjects/node-rest-shop/client/node_modules/ra-core/esm/dataProvider/useRefreshWhenVisible.js"],"names":["useEffect","useRefresh","useIsAutomaticRefreshEnabled","useRefreshWhenVisible","delay","refresh","automaticRefreshEnabled","lastHiddenTime","handleVisibilityChange","document","hidden","Date","now","addEventListener","capture","removeEventListener"],"mappings":"AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,SAASC,UAAT,QAA2B,eAA3B;AACA,OAAOC,4BAAP,MAAyC,gCAAzC;AACA;;;;;;AAKA,IAAIC,qBAAqB,GAAG,UAAUC,KAAV,EAAiB;AACzC,MAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,IAAAA,KAAK,GAAG,OAAO,EAAP,GAAY,CAApB;AAAwB;;AAChD,MAAIC,OAAO,GAAGJ,UAAU,EAAxB;AACA,MAAIK,uBAAuB,GAAGJ,4BAA4B,EAA1D;AACAF,EAAAA,SAAS,CAAC,YAAY;AAClB,QAAIO,cAAJ;;AACA,QAAIC,sBAAsB,GAAG,YAAY;AACrC,UAAI,CAACF,uBAAL,EAA8B;AAC1B;AACH;;AACD,UAAIG,QAAQ,CAACC,MAAb,EAAqB;AACjB;AACAH,QAAAA,cAAc,GAAGI,IAAI,CAACC,GAAL,EAAjB;AACH,OAHD,MAIK;AACD;AACA,YAAID,IAAI,CAACC,GAAL,KAAaL,cAAb,GAA8BH,KAAlC,EAAyC;AACrCC,UAAAA,OAAO;AACV;;AACDE,QAAAA,cAAc,GAAG,IAAjB;AACH;AACJ,KAfD;;AAgBAE,IAAAA,QAAQ,CAACI,gBAAT,CAA0B,kBAA1B,EAA8CL,sBAA9C,EAAsE;AAClEM,MAAAA,OAAO,EAAE;AADyD,KAAtE;AAGA,WAAO,YAAY;AACf,aAAOL,QAAQ,CAACM,mBAAT,CAA6B,kBAA7B,EAAiDP,sBAAjD,EAAyE;AAAEM,QAAAA,OAAO,EAAE;AAAX,OAAzE,CAAP;AACH,KAFD;AAGH,GAxBQ,EAwBN,CAACR,uBAAD,EAA0BF,KAA1B,EAAiCC,OAAjC,CAxBM,CAAT;AAyBH,CA7BD;;AA8BA,eAAeF,qBAAf","sourcesContent":["import { useEffect } from 'react';\r\nimport { useRefresh } from '../sideEffect';\r\nimport useIsAutomaticRefreshEnabled from './useIsAutomaticRefreshEnabled';\r\n/**\r\n * Trigger a refresh of the page when the page comes back from background after a certain delay\r\n *\r\n * @param {number} delay Delay in milliseconds since the time the page was hidden. Defaults to 5 minutes.\r\n */\r\nvar useRefreshWhenVisible = function (delay) {\r\n    if (delay === void 0) { delay = 1000 * 60 * 5; }\r\n    var refresh = useRefresh();\r\n    var automaticRefreshEnabled = useIsAutomaticRefreshEnabled();\r\n    useEffect(function () {\r\n        var lastHiddenTime;\r\n        var handleVisibilityChange = function () {\r\n            if (!automaticRefreshEnabled) {\r\n                return;\r\n            }\r\n            if (document.hidden) {\r\n                // tab goes hidden\r\n                lastHiddenTime = Date.now();\r\n            }\r\n            else {\r\n                // tab goes visible\r\n                if (Date.now() - lastHiddenTime > delay) {\r\n                    refresh();\r\n                }\r\n                lastHiddenTime = null;\r\n            }\r\n        };\r\n        document.addEventListener('visibilitychange', handleVisibilityChange, {\r\n            capture: true,\r\n        });\r\n        return function () {\r\n            return document.removeEventListener('visibilitychange', handleVisibilityChange, { capture: true });\r\n        };\r\n    }, [automaticRefreshEnabled, delay, refresh]);\r\n};\r\nexport default useRefreshWhenVisible;\r\n"]},"metadata":{},"sourceType":"module"}